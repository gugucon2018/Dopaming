<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
                        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--mapper = dao-->
<mapper namespace="ComplainDAO"> 

<!--신고사항 입력-->
<insert id="complain_insert">
    INSERT INTO complain(
    					 	complain_no,
    					 	complain_type,
							complain_title,
							complain_content
									)
				VALUES (<!-- vo에 값들을 땡겨와 넘긴다 -->
					complain_seq.nextval
					,#{complain_type} 
					,#{complain_title}
					,#{complain_content}
					)
</insert>

<!-- 단건삭제 -->
<delete id="notice_delete">
	DELETE 
	from notice
	where notice_no = #{notice_no}
</delete>

<!--공지사항 단건 출력-->
<select id="notice_select" resultType="notice_vo">
select notice_no
       ,notice_title
       ,notice_content
       ,notice_date
from notice
where notice_no= #{notice_no} 
</select>
   
<!--공지사항 목록 출력-->
<select id="complain_selectlist" resultType="complain_vo">
 
  select a.* from ( select b.*, rownum rn from ( 
 				
 				select * 
				from complain
				
				<where> <!-- 동적연산자가 있으면 자동으로 where가 붙는 방식 -->
          			<if test="complain_type != null"> 
           				complain_type = #{complain_type}
          			</if>
    			</where>
						 
				order by complain_date desc
				
  ) b) a where rn between #{first} and #{last}
</select>

<!--페이징 -->
<select id="complain_selectlist_cnt" resultType="int">
		SELECT count(*)
		FROM complain
		<where> <!-- 동적연산자가 있으면 자동으로 where가 붙는 방식 -->
        	<if test="complain_type != null"> 
        		complain_type = #{complain_type}
        	</if>
    	</where>
</select>

<!-- 공지사항 수정 -->
<update id="notice_update">
		update notice 
		set notice_title = #{notice_title},
			notice_content = #{notice_content} 
		where notice_no = #{notice_no}
</update>   
</mapper>
