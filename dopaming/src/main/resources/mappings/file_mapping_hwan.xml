<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
                        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--mapper = dao -->
<mapper namespace="FileDAOHwan">

	<insert id="file_insert_hwan">
		INSERT INTO file_upload(
		file_no,
		group_no,
		member_id,
		file_name,
		file_storage,
		upload_date
		)values(
		FILE_UPLOAD_SEQ_HWAN.nextval,
		#{groupNo},
		#{memberId},
		#{fileName},
		#{fileStorage},
		SYSDATE
		)
	</insert>

	<insert id="board_insert_hwan">
		<selectKey keyProperty="boardNo" resultType="int"
			order="BEFORE">
			select BOARD_INSERT_SEQ_HWAN.nextval from dual
		</selectKey>
		INSERT INTO board(
		board_no,
		board_title,
		member_id,
		category_big,
		category_small,
		board_content,
		board_img,
		board_acorn
		)values(
		#{boardNo},
		#{boardTitle},
		#{memberId},
		#{categoryBig},
		#{categorySmall},
		#{boardContent},
		#{boardImg},
		#{boardAcorn}
		)
	</insert>
	<select id="filePost_hwan" resultType="com.dopaming.www.file.FilePostVO_Hwan">
		select distinct b.board_no,
		b.category_big,b.category_small,b.board_acorn,b.member_id,b.board_content
		,b.board_img,sum(f.file_storage)
		from board b inner join file_upload f
		on board_no = group_no inner join members m
		on m.member_id =b.member_id
		<where>
			<if test="board_no!=null and board_no !='' ">
				 b.board_no=#{board_no}
			</if>
		</where>
		group by b.board_no, b.category_big, b.category_small, b.board_acorn,
		b.member_id, b.board_content,b.board_img

	</select>
</mapper>